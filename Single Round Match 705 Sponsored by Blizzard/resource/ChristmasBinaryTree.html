<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td>Agus has a binary Christmas tree.
More precisely, the decorative balls on his tree are arranged into a complete binary tree with <b>depth</b> levels.
At the top of the Christmas tree there is a single ball: the root of the binary tree of balls.
This is the only ball on level 1.
For each x between 1 and <b>depth</b>-1, inclusive, each ball on level x has exactly two children on level x+1: one ball that is its left child and one ball that is its right child.
Hence, there are exactly 2^x balls on level x.
The balls on level <b>depth</b> are the leaves of the tree.
<br></br>
There are N colors, numbered 0 through N-1.
Each ball has one of those N colors.
The colors of the balls follow a simple pattern:
If the color of a ball is c, then the color of its left child is <b>left</b>[c] and the color of its right child is <b>right</b>[c].
<br></br>
You are given the long <b>depth</b>.
You are also given the int[]s <b>left</b> and <b>right</b>, each with N elements.
<br></br>
You do not know the colors of any of the balls on Agus's tree.
Obviously, the colors of all balls are determined by the color of the ball that is the root of the tree.
For each possible color r of the root of the tree, do the following:
<ol>
<li>For each i, determine c(i) = the number of leaves of color i.</li>
<li>Compute the value v(r) = (c(0)^2 + c(1)^2 + ... + c(N-1)^2) modulo 10^9+7.</li>
</ol>

Return the largest of all possible values v(r).
<br></br>
Note that the maximum of all v(r) is taken only after the modulo operator is used to compute each of them.
In other words, we are <i>not necessarily</i> maximizing the sum of c(i)^2, we are maximizing the remainder that sum can give modulo 10^9+7.</td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>ChristmasBinaryTree</td></tr><tr><td>Method:</td><td>count</td></tr><tr><td>Parameters:</td><td>long, int[], int[]</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int count(long depth, int[] left, int[] right)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>depth</b> will be between 1 and 10^18 inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>left</b> will contain between 1 and 100 elements inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>left</b> will be between 0 and N-1 inclusive where N is the number of elements of <b>left</b>.</td></tr><tr><td align="center" valign="top">-</td><td><b>right</b> and <b>left</b> will contain the same number of elements.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>right</b> will be between 0 and N-1 inclusive where N is the number of elements of <b>right</b>.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>1</pre></td></tr><tr><td><pre>{0}</pre></td></tr><tr><td><pre>{0}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1</pre></td></tr><tr><td><table><tr><td colspan="2">This tree only has a single level.
The root of the node is therefore also its only leaf.
There is only one color: color 0.
We have c(0) = 1 and v(0) = (1^2 modulo 10^9+7) = 1.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>3</pre></td></tr><tr><td><pre>{0,1,2}</pre></td></tr><tr><td><pre>{0,1,2}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 16</pre></td></tr><tr><td><table><tr><td colspan="2">There are four leaves.
All four leaves always have the same color as each other, because all balls in this tree have the same color as its root.
This means that one of the c(i) is always equal to 4 while the other two are zeros.
Then, c(0)^2 + c(1)^2 + c(2)^2 is always 16.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>4</pre></td></tr><tr><td><pre>{1,2,0}</pre></td></tr><tr><td><pre>{2,0,1}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 22</pre></td></tr><tr><td><table><tr><td colspan="2">This time the arrays <b>left</b> and <b>right</b> are such that there are three distinct colors, and whenever a ball A has children B and C, each of the balls A, B, and C has a different color.
In this setting we can prove that c(0), c(1), and c(2) will always be 3, 3, and 2, in some order.
It follows that for any color r of the root we have v(r) = 3^2 + 3^2 + 2^2 = 22.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>4</pre></td></tr><tr><td><pre>{0,2,2}</pre></td></tr><tr><td><pre>{1,1,2}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 64</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>1000000000000</pre></td></tr><tr><td><pre>{0,1,2,3}</pre></td></tr><tr><td><pre>{1,1,2,2}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 465080044</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>